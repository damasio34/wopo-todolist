var CryptoJS=CryptoJS||function(e,t){var n={},o=n.lib={},r=function(){},i=o.Base={extend:function(e){r.prototype=this;var t=new r;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=o.WordArray=i.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,o=this.sigBytes;if(e=e.sigBytes,this.clamp(),o%4)for(var r=0;e>r;r++)t[o+r>>>2]|=(n[r>>>2]>>>24-8*(r%4)&255)<<24-8*((o+r)%4);else if(65535<n.length)for(r=0;e>r;r+=4)t[o+r>>>2]=n[r>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],o=0;t>o;o+=4)n.push(4294967296*e.random()|0);return new s.init(n,t)}}),a=n.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],o=0;e>o;o++){var r=t[o>>>2]>>>24-8*(o%4)&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],o=0;t>o;o+=2)n[o>>>3]|=parseInt(e.substr(o,2),16)<<24-4*(o%8);return new s.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],o=0;e>o;o++)n.push(String.fromCharCode(t[o>>>2]>>>24-8*(o%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],o=0;t>o;o++)n[o>>>2]|=(255&e.charCodeAt(o))<<24-8*(o%4);return new s.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,o=n.words,r=n.sigBytes,i=this.blockSize,a=r/(4*i),a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0);if(t=a*i,r=e.min(4*t,r),t){for(var u=0;t>u;u+=i)this._doProcessBlock(o,u);u=o.splice(0,t),n.sigBytes-=r}return new s.init(u,r)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=f.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}});var d=n.algo={};return n}(Math);!function(){var e=CryptoJS,t=e.lib,n=t.WordArray,o=t.Hasher,r=[],t=e.algo.SHA1=o.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],i=n[1],s=n[2],a=n[3],u=n[4],c=0;80>c;c++){if(16>c)r[c]=0|e[t+c];else{var l=r[c-3]^r[c-8]^r[c-14]^r[c-16];r[c]=l<<1|l>>>31}l=(o<<5|o>>>27)+u+r[c],l=20>c?l+((i&s|~i&a)+1518500249):40>c?l+((i^s^a)+1859775393):60>c?l+((i&s|i&a|s&a)-1894007588):l+((i^s^a)-899497514),u=a,a=s,s=i<<30|i>>>2,i=o,o=l}n[0]=n[0]+o|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[(o+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(o+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=o._createHelper(t),e.HmacSHA1=o._createHmacHelper(t)}(),function(e){"use strict";e.module("wopo.services",[]);var t=e.module("wopo",["wopo.services"]);t.provider("$wopo",function(){var e,t,n=!0;this.setAppId=function(t){e=t},this.setRestApiKey=function(e){t=e},this.setUsuarioPrecisaEstarAutenticado=function(e){n=e},this.$get=function(){return e||console.error("A configuração APP_ID não foi definida"),t||console.error("A configuração REST_API_KEY não foi definida"),{APP_ID:e,REST_API_KEY:t,UsuarioPrecisaEstarAutenticado:n}}})}(angular),function(e,t){t||console.error("É necessário importar a biblioteca cryptojs.js");var n=e.module("wopo.services");n.factory("CryptSha1Service",function(){var e=function(){this.hash=function(e){var n=JSON.stringify(e);return t.SHA1(n).toString()}};return new e})}(angular,CryptoJS),function(e){var t=e.module("wopo.services");t.factory("IonicPopupService",function(e,t){var n=function(){this.alert=function(n,o,r){var i=e.alert({title:n,template:o});t(function(){i.close()},r)},this.confirm=function(t,n,o,r){var i=e.confirm({title:t,template:n});i.then(function(e){e?o():r()})}};return new n})}(angular),function(e){var t=e.module("wopo.services");t.factory("WebStorageService",function(){var e=function(){this.setLocalStorage=function(e,t){t&&(localStorage[e]=JSON.stringify(t))},this.getLocalStorage=function(e){return localStorage[e]?JSON.parse(localStorage[e]):null},this.setSessionStorage=function(e,t){t&&(sessionStorage[e]=JSON.stringify(t))},this.getSessionStorage=function(e){return sessionStorage[e]?JSON.parse(sessionStorage[e]):null}};return new e})}(angular),function(e){var t=e.module("wopo.services");t.factory("LoginService",["$http","$wopo","WebStorageService","CryptSha1Service",function(t,n,o,r){var i=function(){var i=this;this.headers={"X-Parse-Application-Id":n.APP_ID,"X-Parse-REST-API-Key":n.REST_API_KEY},this.getToken=function(){return i.usuarioAutenticado()?o.getLocalStorage("_$token")||o.getSessionStorage("_$token"):void console.error("Usuário não autenticado, por favor efetue login.")},this.incluir=function(n){var s=e.copy(i.headers,s);s["Content-Type"]="application/json";var a={username:n.usuario,password:r.hash(n.senha),email:n.email};return t.post("https://api.parse.com/1/users",a,{headers:s}).success(function(e,t){201==t&&e.sessionToken&&(n.salvarSenha?o.setLocalStorage("_$token",e.sessionToken):o.setSessionStorage("_$token",e.sessionToken))}).error(function(e,t){400===t&&202===e.code&&console.warn("O nome de usuário "+n.usuario+" já está cadastrado."),console.log(e)})},this.login=function(n){i.usuarioAutenticado()&&i.logout();var s=e.copy(i.headers,s);return s["Content-Type"]="application/x-www-form-urlencoded",t.get("https://api.parse.com/1/login",{headers:s,params:{username:n.usuario,password:r.hash(n.senha)}}).success(function(e,t){200==t&&e.sessionToken&&(n.salvarSenha?o.setLocalStorage("_$token",e.sessionToken):o.setSessionStorage("_$token",e.sessionToken))}).error(function(e,t){404==t&&console.error("Usuário ou senha inválido.")})},this.logout=function(){var n=e.copy(i.headers,n),o=i.getToken();return n["X-Parse-Session-Token"]=o,o?t.post("https://api.parse.com/1/logout","",{headers:n}).success(function(e,t,n){200==t&&(sessionStorage.removeItem("_$token"),sessionStorage.clear(),localStorage.removeItem("_$token"),localStorage.clear())}).error(function(e,t){console.log(t),console.log(e.error)}):void 0},this.recuperarSenha=function(n){var o=e.copy(i.headers,o);return o["Content-Type"]="application/json",t.post("https://api.parse.com/1/requestPasswordReset",n,{headers:o}).success(function(e,t){console.log("Senha enviada com sucesso.")}).error(function(e,t){400===t&&202===e.code&&console.warn("O nome de usuário "+n.usuario+" já está cadastrado."),console.log(e)})},this.getUsuario=function(){var n=i.getToken(),o=e.copy(i.headers,o);return o["X-Parse-Session-Token"]=n,t.get("https://api.parse.com/1/users/me",{headers:o}).success(function(e,t){200==t&&console.log(e)}).error(function(e,t){console.log(e.error)})},this.usuarioAutenticado=function(){var e=o.getLocalStorage("_$token")||o.getSessionStorage("_$token");return e&&null!==e?!0:!1}};return new i}])}(angular),function(e){var t=e.module("wopo.services");t.service("FormHelperService",function(t,n,o){var r=this,i=function(e){r.defaultRoute=e},s=function(e){return e.enabledValidations=!e.enabledValidations,e.enabledValidations},a=function(e,n,i){return n.incluir(e).success(function(e){o.alert("Sucesso","Dados cadastrados com sucess!",3e3),t.path(r.defaultRoute)},function(e){throw e})},u=function(t,n,o){return n.editar(t).success(function(n){o.OriginalModel=e.copy(t)},function(e){throw e})},c=function(e){if(!e.formulario)throw"Objeto Formulário não definido";return e.formulario.$valid},l=function(e){return e.formularioEhValido()&&e.usuarioAlterouFormulario()},f=function(e,t){if(e.formulario=t,e.formularioEhValido()){if(e.modoEdicao){if(!e.usuarioAlterouFormulario())return;return e.salvarAlteracao()}return e.salvarInclusao()}},d=function(t){return!e.equals(t.Model,t.OriginalModel)},h=function(t){return e.copy(t.OriginalModel,t.Model),t.Formulario.$setPristine()},p=function(e){return null===e||void 0===e},g=function(e,t,n){t.modoEdicao=!0;var o=function(e,t,n,o,r){n.getById(e).success(function(e){var n=!!e;n&&t.edit(e),o(e,e,n)},function(e){throw e})};return new Promise(function(r,i){t.$config?configuracoesService.getByKey(t.$config).then(function(s){t.$config=s,o(e,t,n,r,i)}):o(e,t,n,r,i)})},v=function(t,n){n.modoEdicao=!0,n.Model=t,n.OriginalModel=e.copy(t)},m=function(t,n){var o=t||{};n.Model=o,n.OriginalModel=e.copy(o),n.carregado=!0},S=function(e){e.usuarioAlterouFormulario()?o.confirm("Alteração não salvas","Deseja sair sem salvar as alterações?",function(){t.path(r.defaultRoute)}):t.path(r.defaultRoute)};this.applySettings=function(e,t,n){if(!t)throw"Variável '$scope' precisa ser definda";t.enabledValidations=!0,t.salvarInclusao=function(){return a(t.Model,n,t)},t.salvarAlteracao=function(){return u(t.Model,n,t)},t.formularioEhValido=function(){return c(t)},t.canSubmit=function(){return l(t)},t.submitForm=function(e){return f(t,e)},t.usuarioAlterouFormulario=function(){return d(t)},t.desfazerAlteracoesDoUsuario=function(){return h(t)},t.sair=function(){return S(t)},t.edit=function(e){return v(e,t)},e.editById=function(e){return g(e,t,n)},e.novoRegistro=function(e){return m(e,t,n)},e.isNullOrUndefined=function(e){return p(e)},e.setDefaultRoute=function(e){return i(e)},t.habilitarOuDesabilitarValidacao=function(){return s(t)},t.ExcluirModal=function(e,o){return _excluirModal(e,o,t,n)},e.confirmar=function(e,n){return _confirmar(t,e,n)}}})}(angular),function(e){var t=e.module("wopo.services");t.service("ListHelperService",function(){var e=function(e,t){return e.getAll().success(function(e){t.itens=e.results},function(e){throw e})},t=function(t,n){e(t,n).success(function(){n.$broadcast("scroll.refreshComplete")},function(e){throw e})},n=function(e,t,n){return e.excluir(n.objectId).success(function(e){t.itens.splice(t.itens.indexOf(n),1)},function(e){throw e})};this.applySettings=function(o,r,i){if(!r)throw"Variável '$scope' precisa ser definda";if(!r)throw"Variável '$modelService' precisa ser definda";r.queryBuscar&&(r.limparBuscar=function(){r.queryBuscar=""}),o.listarItens=function(){return e(i,r)},r.atualizarItens=function(){return t(i,r)},r.excluirItem=function(e){return n(i,r,e)}}})}(angular),function(e){var t=e.module("wopo.services");t.factory("RestServiceBase",["$http","$wopo","WebStorageService","LoginService",function(e,t,n,o){var r=function(){self=this,this.mainRoute=void 0,this.urlBase="https://api.parse.com/1/classes/",this.headers={"X-Parse-Application-Id":t.APP_ID,"X-Parse-REST-API-Key":t.REST_API_KEY},this.setMainRoute=function(e){self.mainRoute=e},this.getAll=function(){if(!self.mainRoute)throw"mainRoute não configurada.";return t.UsuarioPrecisaEstarAutenticado&&(self.headers["X-Parse-Session-Token"]=o.getToken()),e.get(self.urlBase+self.mainRoute,{headers:self.headers})},this.getById=function(n){if(!n)throw"id não informado";if(!this.mainRoute)throw"mainRoute não configurada.";return t.UsuarioPrecisaEstarAutenticado&&(self.headers["X-Parse-Session-Token"]=o.getToken()),e.get(self.urlBase+self.mainRoute+"/"+n,{headers:self.headers})},this.incluir=function(n){if(!self.mainRoute)throw"mainRoute não configurada.";return t.UsuarioPrecisaEstarAutenticado&&(self.headers["X-Parse-Session-Token"]=o.getToken()),e.post(self.urlBase+self.mainRoute,n,{headers:self.headers})},this.editar=function(n){if(!this.mainRoute)throw"mainRoute não configurada.";return t.UsuarioPrecisaEstarAutenticado&&(self.headers["X-Parse-Session-Token"]=o.getToken()),e.put(self.urlBase+self.mainRoute+"/"+n.objectId,n,{headers:self.headers})},this.excluir=function(n){if(!this.mainRoute)throw"mainRoute não configurada.";return t.UsuarioPrecisaEstarAutenticado&&(self.headers["X-Parse-Session-Token"]=o.getToken()),e["delete"](self.urlBase+self.mainRoute+"/"+n,{headers:self.headers})}};return r}])}(angular);